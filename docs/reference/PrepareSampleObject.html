<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Perform preprocessing procedures for a Seurat object to prepare for the sample-level analysis — PrepareSampleObject • scSLIDE</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Perform preprocessing procedures for a Seurat object to prepare for the sample-level analysis — PrepareSampleObject"><meta name="description" content="This is a wrapper function to apply landmark sketching, training data sketching (optional), PLS learning,
and weighted nearest neighbor (WNN) workflow to a single-cell Seurat object to get the necessary components for
sample-level analyses later. The output object can be directly used by GenerateSampleObject to obtain
a sample-level matrix."><meta property="og:description" content="This is a wrapper function to apply landmark sketching, training data sketching (optional), PLS learning,
and weighted nearest neighbor (WNN) workflow to a single-cell Seurat object to get the necessary components for
sample-level analyses later. The output object can be directly used by GenerateSampleObject to obtain
a sample-level matrix."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">scSLIDE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/scSLIDE_COVID19.html">Quick start with scSLIDE</a></li>
<li><a class="dropdown-item" href="../articles/scSLIDE_SEA_AD.html">Applying scSLIDE to large-scale single-cell data</a></li>
<li><a class="dropdown-item" href="../articles/Using_customized_embedding.html">Generate sample-level density matrix using custom embeddings</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/satijalab/scSLIDE/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Perform preprocessing procedures for a Seurat object to prepare for the sample-level analysis</h1>
      <small class="dont-index">Source: <a href="https://github.com/satijalab/scSLIDE/blob/HEAD/R/sample_level_object.R" class="external-link"><code>R/sample_level_object.R</code></a></small>
      <div class="d-none name"><code>PrepareSampleObject.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This is a wrapper function to apply landmark sketching, training data sketching (optional), PLS learning,
and weighted nearest neighbor (WNN) workflow to a single-cell Seurat object to get the necessary components for
sample-level analyses later. The output object can be directly used by <code><a href="GenerateSampleObject.html">GenerateSampleObject</a></code> to obtain
a sample-level matrix.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">PrepareSampleObject</span><span class="op">(</span></span>
<span>  object <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  assay <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  add.hvg <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  group.by.CorTest <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sketch.training <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  group.by.Sketch <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ncells.per.group <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  training.assay.name <span class="op">=</span> <span class="st">"TRAINING"</span>,</span>
<span>  training.sketch.method <span class="op">=</span> <span class="st">"Uniform"</span>,</span>
<span>  ncells.landmark <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  landmark.assay.name <span class="op">=</span> <span class="st">"LANDMARK"</span>,</span>
<span>  landmark.sketch.method <span class="op">=</span> <span class="st">"LeverageScore"</span>,</span>
<span>  ncomp <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  pls.function <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"plsr"</span>, <span class="st">"spls"</span>, <span class="st">"cppls"</span><span class="op">)</span>,</span>
<span>  pls.reduction.name <span class="op">=</span> <span class="st">"pls"</span>,</span>
<span>  k.nn <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  name.reduction.1 <span class="op">=</span> <span class="st">"pca"</span>,</span>
<span>  dims.reduction.1 <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">30</span>,</span>
<span>  weighted.nn.name <span class="op">=</span> <span class="st">"weighted.nn"</span>,</span>
<span>  fix.wnn.weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  rm.training.assay <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  max_core <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  future.memory.per.core <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>a Seurat object.</p></dd>


<dt id="arg-assay">assay<a class="anchor" aria-label="anchor" href="#arg-assay"></a></dt>
<dd><p>the assay to perform the analyses on</p></dd>


<dt id="arg-add-hvg">add.hvg<a class="anchor" aria-label="anchor" href="#arg-add-hvg"></a></dt>
<dd><p>a boolen to specify whether the function runs additional correlation test between features and response (Y) to
obtain more response-relevant features to be included in VariableFeatures and used for PLS learning.
See <code><a href="QuickCorTest.html">QuickCorTest</a></code> for details. Default is TRUE.</p></dd>


<dt id="arg-group-by-cortest">group.by.CorTest<a class="anchor" aria-label="anchor" href="#arg-group-by-cortest"></a></dt>
<dd><p>A metadata column name to group cells by before QuickCorTest. If NULL,
falls back to QuickCorTest without grouping. Default is NULL.</p></dd>


<dt id="arg-y">Y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>A metadata column name of responses. Will also be used as the responses for PLS learning.</p></dd>


<dt id="arg-sketch-training">sketch.training<a class="anchor" aria-label="anchor" href="#arg-sketch-training"></a></dt>
<dd><p>a boolen to specify whether the function performs sketching for the Seurat object to get a training subset for PLS learning
(the PLS learned from subset will be projected to the full data). For efficiency, it is recommended to do so when the Seurat object is very
large. If the 'assay' being specified for this Seurat object is an on-disk assay, this parameter must be set to TRUE. Default is FALSE.</p></dd>


<dt id="arg-group-by-sketch">group.by.Sketch<a class="anchor" aria-label="anchor" href="#arg-group-by-sketch"></a></dt>
<dd><p>A metadata column name to group cells by before sketching. If NULL,
falls back to standard sketching without grouping. Default is NULL.</p></dd>


<dt id="arg-ncells-per-group">ncells.per.group<a class="anchor" aria-label="anchor" href="#arg-ncells-per-group"></a></dt>
<dd><p>A positive integer, named vector, or list specifying the number of cells to sample.
Default is 1000 per category in 'group.by.Sketch'. See <code><a href="SketchDataByGroup.html">SketchDataByGroup</a></code> for detailed usage.</p></dd>


<dt id="arg-training-assay-name">training.assay.name<a class="anchor" aria-label="anchor" href="#arg-training-assay-name"></a></dt>
<dd><p>The assay name of the training data.</p></dd>


<dt id="arg-training-sketch-method">training.sketch.method<a class="anchor" aria-label="anchor" href="#arg-training-sketch-method"></a></dt>
<dd><p>Sketching method to use for the training subset. Can be 'LeverageScore' or 'Uniform'.
Default is 'Uniform' because for training we want to obtain an unbiased subset of the original data.
See <code>LeverageScore</code> for details.</p></dd>


<dt id="arg-ncells-landmark">ncells.landmark<a class="anchor" aria-label="anchor" href="#arg-ncells-landmark"></a></dt>
<dd><p>A positive integer specifying the number of 'landmark cells'. The function will generate a new
assay for these 'landmark cells' (please do not confuse it with the training subset). The landmark cells should be a
subset that covers the diverse cell types and cell states of the data. Default is 2000.</p></dd>


<dt id="arg-landmark-assay-name">landmark.assay.name<a class="anchor" aria-label="anchor" href="#arg-landmark-assay-name"></a></dt>
<dd><p>The assay name of the landmark cells. Default is "LANDMARK".</p></dd>


<dt id="arg-landmark-sketch-method">landmark.sketch.method<a class="anchor" aria-label="anchor" href="#arg-landmark-sketch-method"></a></dt>
<dd><p>Sketching method to use for the landmark cells. Can be 'LeverageScore' or 'Uniform'.
Default is 'LeverageScore' because we want the landmark cells to be as diverse/representative as possible.
See <code>LeverageScore</code> for details.</p></dd>


<dt id="arg-ncomp">ncomp<a class="anchor" aria-label="anchor" href="#arg-ncomp"></a></dt>
<dd><p>Number of components to compute</p></dd>


<dt id="arg-pls-function">pls.function<a class="anchor" aria-label="anchor" href="#arg-pls-function"></a></dt>
<dd><p>PLS function from pls package to run (options: plsr, spls, cppls)</p></dd>


<dt id="arg-pls-reduction-name">pls.reduction.name<a class="anchor" aria-label="anchor" href="#arg-pls-reduction-name"></a></dt>
<dd><p>PLS dimensional reduction name</p></dd>


<dt id="arg-k-nn">k.nn<a class="anchor" aria-label="anchor" href="#arg-k-nn"></a></dt>
<dd><p>The number of nearest neighbors to compute for each modality</p></dd>


<dt id="arg-name-reduction-">name.reduction.1<a class="anchor" aria-label="anchor" href="#arg-name-reduction-"></a></dt>
<dd><p>The name of the DimReduc to use as the 1st embedding (the 2nd is the PLS embedding) in the WNN process.</p></dd>


<dt id="arg-dims-reduction-">dims.reduction.1<a class="anchor" aria-label="anchor" href="#arg-dims-reduction-"></a></dt>
<dd><p>The dimensions for reduction.1 to use during the WNN process.</p></dd>


<dt id="arg-weighted-nn-name">weighted.nn.name<a class="anchor" aria-label="anchor" href="#arg-weighted-nn-name"></a></dt>
<dd><p>Multimodal neighbor object name</p></dd>


<dt id="arg-fix-wnn-weights">fix.wnn.weights<a class="anchor" aria-label="anchor" href="#arg-fix-wnn-weights"></a></dt>
<dd><p>Pre-specified modality weights. If provided, skips the calculation and uses these weights directly.
Should be a list with the same length as reduction.list.</p></dd>


<dt id="arg-rm-training-assay">rm.training.assay<a class="anchor" aria-label="anchor" href="#arg-rm-training-assay"></a></dt>
<dd><p>Whether to remove the training assay after running PrepareSampleObject(). This is used to reduce the
memory usage when the seurat object is large (e.g., a large on-disk object). Default is FALSE.</p></dd>


<dt id="arg-max-core">max_core<a class="anchor" aria-label="anchor" href="#arg-max-core"></a></dt>
<dd><p>The number of cores to use for parallelization when running the WNN process (but not other processes).
Note that if the user has already set the "future::plan()" before running the function,
it will ignore this parameter and respect user's future plan (and the plan()
will be applied to other functions being called, including ScaleData()).
Default is 1 for sequential processing.</p></dd>


<dt id="arg-future-memory-per-core">future.memory.per.core<a class="anchor" aria-label="anchor" href="#arg-future-memory-per-core"></a></dt>
<dd><p>The memory allocation per core for options(future.globals.maxSize = ...), and the calculation
is future.globals.maxSize = max_core × future.memory.per.core × 1024 × 1024 bytes. Default is 2000 (unit in MB).</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Print progress and diagnostic messages</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments passed to other methods</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>return a Seurat object that contains a weighted.nn Neighbor object between the landmark cells and all the other cells.
the Seurat object will also contain a landmark assay (and a training assay if sketch.training == TRUE).</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Longda Jiang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>


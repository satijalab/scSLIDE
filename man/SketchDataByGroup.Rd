% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sketching.R
\name{SketchDataByGroup}
\alias{SketchDataByGroup}
\title{Sketch Data by Group}
\usage{
SketchDataByGroup(
  object,
  group.by = NULL,
  assay = NULL,
  ncells = 1000L,
  sketched.assay = "sketch",
  method = c("Uniform", "LeverageScore"),
  var.name = "leverage.score",
  cells = NULL,
  over.write = FALSE,
  seed = 123L,
  cast = "dgCMatrix",
  verbose = TRUE,
  features = NULL,
  min.cells.per.group = 10L,
  ...
)
}
\arguments{
\item{object}{A Seurat object.}

\item{group.by}{A metadata column name to group cells by before sketching. If NULL,
falls back to standard sketching without grouping. Default is NULL.}

\item{assay}{Assay name. Default is NULL, in which case the default assay of the object is used.}

\item{ncells}{A positive integer, named vector, or list specifying the number of cells to sample.
\itemize{
\item If a single integer: same number of cells sampled from each group and layer
\item If a named vector with group names: specific number per group
\item If a named list with group names containing layer vectors: specific number per group per layer
}
Default is 1000.}

\item{sketched.assay}{Sketched assay name. A sketch assay is created or overwritten with the sketch data.
Default is 'sketch'.}

\item{method}{Sketching method to use. Can be 'LeverageScore' or 'Uniform'.
Default is 'Uniform'.}

\item{var.name}{A metadata column name to store the leverage scores. Default is 'leverage.score'.}

\item{cells}{A vector that contains the IDs of the cells that the user wants to keep. If this is set,
these user-defined cells will be directly used to generate the sketch, ignoring group.by parameter.}

\item{over.write}{Whether to overwrite existing column in the metadata. Default is FALSE.}

\item{seed}{A positive integer for the seed of the random number generator. Default is 123.}

\item{cast}{The type to cast the resulting assay to. Default is 'dgCMatrix'.}

\item{verbose}{Print progress and diagnostic messages. Default is TRUE.}

\item{features}{A character vector of feature names to include in the sketched assay.}

\item{min.cells.per.group}{Minimum number of cells required per group to perform sketching.
Groups with fewer cells will be included entirely. Default is 10.}

\item{...}{Arguments passed to other methods}
}
\value{
A Seurat object with the sketched data added as a new assay. The metadata will contain
information about which groups each sketched cell belongs to.
}
\description{
This function uses sketching methods to downsample high-dimensional single-cell RNA expression data
within specified groups/categories, which can help with scalability for large datasets while
maintaining representation across different cell types or conditions.
}
\details{
When \code{group.by} is specified, the function performs the following steps: \cr
\enumerate{
\item Splits cells into groups based on the metadata column \cr
\item Calculates leverage scores (if method = 'LeverageScore') within each group \cr
\item Samples the specified number of cells from each group \cr
\item Combines all sampled cells into the sketched assay
}

This approach ensures that rare cell types or conditions are not underrepresented
in the final sketched dataset.
}
\examples{
\dontrun{
# Basic usage with grouping by cell type
sketched_obj <- SketchDataByGroup(
  object = seurat_obj,
  group.by = "cell_type",
  ncells = 500
)

# Different number of cells per group
sketched_obj <- SketchDataByGroup(
  object = seurat_obj,
  group.by = "condition",
  ncells = c("control" = 1000, "treatment" = 800)
)

# Without grouping (falls back to original behavior)
sketched_obj <- SketchDataByGroup(
  object = seurat_obj,
  ncells = 5000
)
}

}
\concept{sketching}
